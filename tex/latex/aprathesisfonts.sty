% !TEX encoding = UTF-8 Unicode
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% APRA Thesis Font Setup 
% Style File
%
% Style license:
% LPPL v1.3c (http://www.latex-project.org/lppl) OR (at your option)
% any later version of the LPPL OR (at your option)
% GPLV3 (https://www.gnu.org/licenses/gpl.html) OR (at your option)
% any later version of the GPL.
% Moreover, no conditions are placed on distributing modified versions.
% (In particular, you may modify and distribute the work as if you are the
% Current Maintainer, as defined by the LPPL v. 1.3c or any later version.)
% If you license your modified work with the LPPL, you may (at your option)
% also grant this permission in your modified versions, but it is not required
% for you to do so.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\def\filename{aprathesisfonts}
\def\fileversion{$Revision: 1.0.3 $}
\def\filedate{2016/10/23}
\def\fileauthor{$Author: Louis Melahn, L.C.$}

\NeedsTeXFormat{LaTeX2e}[1996/12/01]

\ProvidesPackage{\filename}[\filedate \fileversion %
  : The fonts for an APRA thesis (based on Libertinus).]

\RequirePackage{fontspec}

\defaultfontfeatures{Ligatures=TeX, Numbers=OldStyle}
\setmainfont{Libertinus Serif}
\setsansfont[Scale=MatchLowercase]{Libertinus Sans}
\setmonofont[Scale=MatchLowercase]{Libertinus Mono}

% Make URL use roman (serif), not monospaced, type.
%\renewcommand\UrlFont{\rmfamily}
\urlstyle{rm}

\RequirePackage{unicode-math}
\setmathfont{Libertinus Math}

\RequirePackage{polyglossia}
\setdefaultlanguage[variant=us]{english}
\setotherlanguage[variant=ancient]{greek}

% The following code substitutes the FreeSerif equivalents
% of the versicle and responsum glyphs, since Linux Libertine O
% does not have them.

\newfontfamily{\liturgyFont}{FreeSerif}

\RequirePackage{ifxetex}

\ifxetex{

    \XeTeXinterchartokenstate=1
    
    \newXeTeXintercharclass\responsumSub
    \XeTeXcharclass"211F=\responsumSub
    \XeTeXinterchartoks 0 \responsumSub = {\begingroup\liturgyFont}
    \XeTeXinterchartoks 255 \responsumSub = {\begingroup\liturgyFont}
    \XeTeXinterchartoks \responsumSub 0 = {\endgroup}
    \XeTeXinterchartoks \responsumSub 255 = {\endgroup}
    
    \newXeTeXintercharclass\versicleSub
    \XeTeXcharclass"2123=\versicleSub
    \XeTeXinterchartoks 0 \versicleSub = {\begingroup\liturgyFont}
    \XeTeXinterchartoks 255 \versicleSub = {\begingroup\liturgyFont}
    \XeTeXinterchartoks \versicleSub 0 = {\endgroup}
    \XeTeXinterchartoks \versicleSub 255 = {\endgroup}

} \else \fi